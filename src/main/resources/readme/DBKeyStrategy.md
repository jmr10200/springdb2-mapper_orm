### 참고 : 권장하는 식별자 선택 전략

**데이터베이스 기본 키는 다음 3가지 조건을 모두 만족해야 한다.**
<ol>
<li>null 값은 허용하지 않는다.</li>
<li>유일해야 한다.</li>
<li>변해서는 안 된다.</li>
</ol>

**테이블의 기본 키를 선택하는 전략은 크게 2가지가 있다.**
<ol>
    <li>자연 키 (natural key)</li>
        <ol>
            <li>비즈니스에 의미가 있는 키</li>
            <li>예 : 주민등록번호, email, 전화번호</li>
        </ol>
    <li>대리 키 (surrogate key)</li>
        <ol>
            <li>비즈니스와 관련 없는 임의로 만들어진 키, 대체 키 로도 불린다.</li>
            <li>예 : oracle sequence, auto_increment, identity, 키 생성 테이블 사용</li>
        </ol>
</ol>

>**자연 키 보다는 대리 키를 권장한다**
> 
> 예를들어 자연 키인 전화번호를 기본 키로 사용한다면, 그 번호가 유일할 수는 있지만,
> 사람마다 전화번호가 없을 수도 있고, 변경될 수도 있기 때문에 기본 키로 적절하지 않다.
> 문제는 주민등록번호 처럼 그럴듯하게 보이는 값이다.
> 이 값은 null 이 되지 않고 유일하며, 변하지 않는다.
> 3가지 조건을 모두 만족하는 것 같다.
> 하지만 현실과 비즈니스 규칙은 생각보다 쉽게 변한다.
> 주민등록번호는 여러가지 이유로 변경될 수 있다.

>**비즈니스 환경은 언젠가 변한다**
> 
> 회원 테이블에 주민등록번호가 PK 로 되어있다.
> 회원과 관련된 수많은 테이블에서 join 을 위해 주민등록번호를 외래 키로 가지고 있다.
> 심지어 자식의 자식 테이블까지 주민등록번호로 연결되어 있다.
> 문제는 법적으로 주민등록번호를 저장할 수 없다는 정부정책의 변경으로 발생한다.
> DB 는 물론이고, 수많은 logic 까지 수정해야한다.

> 기본 키의 조건을 현재는 물론이고 미래까지 충족하는 자연 키를 찾는 일은 쉽지 않다.
> 대리 키는 비즈니스와 무관한 임의의 값이므로 요구사항이 변경되어도 기본 키가 변경되는 일은 드물다.
> 대리 키를 기본 키로 사용하되 주민등록번호나 이메일처럼 자연 키의 후보가 되는 컬럼들은
> 필요에 따라 유니크 인덱스를 설정해서 사용하는 것을 권장한다.
> <br>
> 참고로 JPA 는 모든 엔티티에 일관된 방식으로 대리키 사용을 권장한다.
> 비즈니스 요구사항은 계속해서 변하는데 테이블은 한 번 정의하면 변경하기 어렵다.
> 그런면에서 외부요인에 쉽게 흔들리지 않는 대리 키가 일반적으로 좋은 선택이 될 수 있다.
